<?xml version="1.0"?>

<!-- CAUTION, if preferences.xml isn't with 6 views, update below :

     - cycle keys "v" and "V".
     - seats keys "Ctrl-E", "Ctrl-J", "Ctrl-K", "Ctrl-O".
     - eventually "Ctrl-V".


     Known problems :
     ==============
     - for simplification, trims (elevator, autopilot and autothrottle) works without voltage; which could be wrong if
     electrical commands.
     - when no voltage, one cannot disable flaps, if activated from joystick.
-->


<PropertyList>

   <key n="1">
    <name>Ctrl-A</name>
    <desc>Toggle autopilot altitude lock.</desc>
    <binding>
     <condition include="../Panels/Instruments/concorde-cond-voltage-autopilot.xml"/>
     <command>nasal</command>
     <script>globals.Concorde.autopilotsystem.aptogglealtitudeexport();</script>
    </binding>
    <binding>
     <command>property-toggle</command>
     <property>/instrumentation/generic/click</property>
    </binding>
   </key>

   <key n="2">
    <name>Ctrl-B</name>
    <desc>reverse thrust</desc>
    <binding>
     <command>property-toggle</command>
     <property>/controls/engines/engine[0]/reverser</property>
    </binding>
    <binding>
     <command>property-toggle</command>
     <property>/controls/engines/engine[1]/reverser</property>
    </binding>
    <binding>
     <command>property-toggle</command>
     <property>/controls/engines/engine[2]/reverser</property>
    </binding>
    <binding>
     <command>property-toggle</command>
     <property>/controls/engines/engine[3]/reverser</property>
    </binding>
   </key>

<!-- Autopilot is easily disconnected from a thumb switch on the yoke. -->

   <key n="4">
    <name>CTRL-D</name>
    <desc>Disconnect autopilot</desc>
    <binding>
     <command>nasal</command>
     <script>globals.Concorde.autopilotsystem.apdiscexport();</script>
    </binding>
    <binding>
     <command>property-toggle</command>
     <property>/instrumentation/generic/click</property>
    </binding>
   </key>

<!-- Engineer Seat -->

   <key n="5">
    <name>Ctrl-E</name>
    <desc>Toggle engineer/captain view</desc>

    <!-- engineer seat -->

    <binding>
     <condition>
      <not>
       <property>/sim/current-view/seat/engineer</property>
      </not>
     </condition>
     <command>property-assign</command>
     <property>/sim/current-view/view-number</property>
     <value type="int">6</value>
    </binding>

    <!--captain seat -->

    <binding>
     <condition>
      <property>/sim/current-view/seat/engineer</property>
     </condition>
     <command>property-assign</command>
     <property>/sim/current-view/view-number</property>
     <value type="int">0</value>
    </binding>

    <binding>
     <command>property-toggle</command>
     <property>/sim/current-view/seat/engineer</property>
    </binding>

    <binding>
     <condition>
      <and>
       <not>
        <property>/sim/current-view/seat/overhead</property>
       </not>
       <not>
        <property>/sim/current-view/seat/copilot</property>
       </not>
       <not>
        <property>/sim/current-view/seat/steward</property>
       </not>
      </and>
     </condition>
     <command>property-toggle</command>
     <property>/sim/current-view/seat/captain</property>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/overhead</property>
     <value type="bool">false</value>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/copilot</property>
     <value type="bool">false</value>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/steward</property>
     <value type="bool">false</value>
    </binding>
   </key>

<!-- Reheat -->

   <key n="6">
    <name>Ctrl-F</name>
    <desc>Reheat</desc>
    <binding n= "0">
     <command>property-toggle</command>
     <property>controls/engines/engine[0]/augmentation</property>
    </binding>
    <binding n= "1">
     <command>property-toggle</command>
     <property>controls/engines/engine[1]/augmentation</property>
    </binding>
    <binding n= "2">
     <command>property-toggle</command>
     <property>controls/engines/engine[2]/augmentation</property>
    </binding>
    <binding n= "3">
     <command>property-toggle</command>
     <property>controls/engines/engine[3]/augmentation</property>
    </binding>
    <binding>
     <command>property-toggle</command>
     <property>/instrumentation/generic/click</property>
    </binding>
   </key>

   <key n="7">
    <name>Ctrl-G</name>
    <desc>Toggle autopilot glide slope lock.</desc>
    <binding>
     <condition include="../Panels/Instruments/concorde-cond-voltage-autopilot.xml"/>
     <command>nasal</command>
     <script>globals.Concorde.autopilotsystem.aptoggleglideexport();</script>
    </binding>
    <binding>
     <command>property-toggle</command>
     <property>/instrumentation/generic/click</property>
    </binding>
   </key>

   <key n="8">
    <name>Ctrl-H</name>
    <desc>Toggle autopilot heading lock.</desc>
    <binding>
     <condition include="../Panels/Instruments/concorde-cond-voltage-autopilot.xml"/>
     <command>nasal</command>
     <script>globals.Concorde.autopilotsystem.aptoggleheadingexport();</script>
    </binding>
    <binding>
     <command>property-toggle</command>
     <property>/instrumentation/generic/click</property>
    </binding>
   </key>

<!-- Copilot Seat -->

   <key n="10">
    <name>Ctrl-J</name>
    <desc>Toggle copilot view.</desc>

    <!-- copilot seat -->

    <binding>
     <condition>
      <not>
       <property>/sim/current-view/seat/copilot</property>
      </not>
     </condition>
     <command>property-assign</command>
     <property>/sim/current-view/view-number</property>
     <value type="int">8</value>
    </binding>

    <!--captain seat -->

    <binding>
     <condition>
      <property>/sim/current-view/seat/copilot</property>
     </condition>
     <command>property-assign</command>
     <property>/sim/current-view/view-number</property>
     <value type="int">0</value>
    </binding>

    <binding>
     <command>property-toggle</command>
     <property>/sim/current-view/seat/copilot</property>
    </binding>

    <binding>
     <condition>
      <and>
       <not>
        <property>/sim/current-view/seat/engineer</property>
       </not>
       <not>
        <property>/sim/current-view/seat/overhead</property>
       </not>
       <not>
        <property>/sim/current-view/seat/steward</property>
       </not>
      </and>
     </condition>
     <command>property-toggle</command>
     <property>/sim/current-view/seat/captain</property>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/engineer</property>
     <value type="bool">false</value>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/overhead</property>
     <value type="bool">false</value>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/steward</property>
     <value type="bool">false</value>
    </binding>
   </key>

<!-- Steward Seat -->

   <key n="11">
    <name>Ctrl-K</name>
    <desc>Toggle steward view.</desc>

    <!-- steward seat -->

    <binding>
     <condition>
      <not>
       <property>/sim/current-view/seat/steward</property>
      </not>
     </condition>
     <command>property-assign</command>
     <property>/sim/current-view/view-number</property>
     <value type="int">9</value>
    </binding>

    <!--captain seat -->

    <binding>
     <condition>
      <property>/sim/current-view/seat/steward</property>
     </condition>
     <command>property-assign</command>
     <property>/sim/current-view/view-number</property>
     <value type="int">0</value>
    </binding>

    <binding>
     <command>property-toggle</command>
     <property>/sim/current-view/seat/steward</property>
    </binding>

    <binding>
     <condition>
      <and>
       <not>
        <property>/sim/current-view/seat/engineer</property>
       </not>
       <not>
        <property>/sim/current-view/seat/overhead</property>
       </not>
       <not>
        <property>/sim/current-view/seat/copilot</property>
       </not>
      </and>
     </condition>
     <command>property-toggle</command>
     <property>/sim/current-view/seat/captain</property>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/engineer</property>
     <value type="bool">false</value>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/overhead</property>
     <value type="bool">false</value>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/copilot</property>
     <value type="bool">false</value>
    </binding>
   </key>

   <key n="14">
    <name>Ctrl-N</name>
    <desc>Toggle autopilot nav1 lock.</desc>
    <binding>
     <condition include="../Panels/Instruments/concorde-cond-voltage-autopilot.xml"/>
     <command>nasal</command>
     <script>globals.Concorde.autopilotsystem.aptogglenav1export();</script>
    </binding>
    <binding>
     <command>property-toggle</command>
     <property>/instrumentation/generic/click</property>
    </binding>
   </key>

<!-- Overhead Seat -->

   <key n="15">
    <name>Ctrl-O</name>
    <desc>Toggle overhead view.</desc>

    <!-- overhead seat -->

    <binding>
     <condition>
      <not>
       <property>/sim/current-view/seat/overhead</property>
      </not>
     </condition>
     <command>property-assign</command>
     <property>/sim/current-view/view-number</property>
     <value type="int">7</value>
    </binding>

    <!--captain seat -->

    <binding>
     <condition>
      <property>/sim/current-view/seat/overhead</property>
     </condition>
     <command>property-assign</command>
     <property>/sim/current-view/view-number</property>
     <value type="int">0</value>
    </binding>

    <binding>
     <command>property-toggle</command>
     <property>/sim/current-view/seat/overhead</property>
    </binding>

    <binding>
     <condition>
      <and>
       <not>
        <property>/sim/current-view/seat/engineer</property>
       </not>
       <not>
        <property>/sim/current-view/seat/copilot</property>
       </not>
       <not>
        <property>/sim/current-view/seat/steward</property>
       </not>
      </and>
     </condition>
     <command>property-toggle</command>
     <property>/sim/current-view/seat/captain</property>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/engineer</property>
     <value type="bool">false</value>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/copilot</property>
     <value type="bool">false</value>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/steward</property>
     <value type="bool">false</value>
    </binding>
   </key>

   <key n="16">
    <name>Ctrl-P</name>
    <desc>Toggle pitch hold.</desc>
    <binding>
     <condition include="../Panels/Instruments/concorde-cond-voltage-autopilot.xml"/>
     <command>nasal</command>
     <script>globals.Concorde.autopilotsystem.aptogglepitchexport();</script>
    </binding>
    <binding>
     <command>property-toggle</command>
     <property>/instrumentation/generic/click</property>
    </binding>
   </key>

   <key n="19">
    <name>Ctrl-S</name>
    <desc>Toggle auto-throttle lock.</desc>
    <binding>
     <condition include="../Panels/Instruments/concorde-cond-voltage-autopilot.xml"/>
     <command>nasal</command>
     <script>globals.Concorde.autothrottlesystem.attogglespeedexport();</script>
    </binding>
    <binding>
     <command>property-toggle</command>
     <property>/instrumentation/generic/click</property>
    </binding>
   </key>

<!-- Views -->

   <key n="22">
    <name>Ctrl-V</name>
    <desc>Select initial view (view 0).</desc>
    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/view-number</property>
     <value type="int">0</value>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/engineer</property>
     <value type="bool">false</value>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/overhead</property>
     <value type="bool">false</value>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/copilot</property>
     <value type="bool">false</value>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/steward</property>
     <value type="bool">false</value>
    </binding>

    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/seat/captain</property>
     <value type="bool">true</value>
    </binding>
   </key>

   <key n="26">
    <name>Ctrl-Z</name>
    <desc>Virtual copilot</desc>
    <binding>
     <command>nasal</command>
     <script>globals.Concorde.autopilotsystem.apcopilotexport();</script>
    </binding>
   </key>

   <key n="71">
    <name>G</name>
    <desc>Gear down.</desc>
    <binding>
     <condition include="../Panels/Instruments/concorde-cond-gear-down.xml"/>
     <command>nasal</command>
     <script>controls.gearToggle()</script>
    </binding>
   </key>

   <key n="86">
    <name>V</name>
    <desc>Scroll in reverse through views.</desc>
    <binding>
     <command>nasal</command>
     <script>
       # if specific view, step once more to ignore captain view 
       if( getprop("/sim/current-view/seat/engineer") ) {
           if( getprop("/sim/current-view/view-number") == 1 ) {
               view.stepView(-2);
               view.stepView(-2);
           }
       }
       elsif( getprop("/sim/current-view/seat/overhead") ) {
           if( getprop("/sim/current-view/view-number") == 1 ) {
               view.stepView(-2);
               view.stepView(-1);
           }
           elsif( getprop("/sim/current-view/view-number") == 7 ) {
               view.stepView(-1);
           }
       }
       elsif( getprop("/sim/current-view/seat/copilot") ) {
           if( getprop("/sim/current-view/view-number") == 1 ) {
               view.stepView(-2);
           }
           elsif( getprop("/sim/current-view/view-number") == 8 ) {
               view.stepView(-2);
           }
       }
       elsif( getprop("/sim/current-view/seat/steward") ) {
           if( getprop("/sim/current-view/view-number") == 1 ) {
               view.stepView(-1);
           }
           elsif( getprop("/sim/current-view/view-number") == 9 ) {
               view.stepView(-3);
           }
       }
       else {
           if( getprop("/sim/current-view/view-number") == 0 ) {
               view.stepView(-1);
               view.stepView(-3);
           }
       }
       # default
       view.stepView(-1);
     </script>
    </binding>
   </key>

   <key n="91">
    <name>[</name>
    <desc>Decrease flaps/nose.</desc>
    <binding>
     <condition include="../Panels/Instruments/concorde-cond-nose-up.xml"/>
     <command>nasal</command>
     <script>controls.flapsDown(-1)</script>
    </binding>
   </key>

   <key n="93">
    <name>]</name>
    <desc>Increase flaps/nose.</desc>
    <binding>
     <condition include="../Panels/Instruments/concorde-cond-nose-down.xml"/>
     <command>nasal</command>
     <script>controls.flapsDown(1)</script>
    </binding>
   </key>

   <key n="100">
    <name>d</name>
    <desc>air ground supply (door)</desc>
    <binding>
     <command>nasal</command>
     <script>globals.Concorde.airbleedsystem.groundserviceexport();</script>
    </binding>
   </key>

<!--
    /sim/current-view/x(yz)-offset-m to watch instruments grazing their panel surface :
    - pilot (y,z) = ( 2.2, -25,01 ), autopilot (x,y,z) = ( -0.3, 2.3, -24.98 ).
    - overhead (y,z) = ( 2.6, -24.65 ), overhead aft ( -0.41, 2.7, -24.4 ).
    - console (y) = ( 1.815 ), console top (y) = ( 1.9 ).
    - pedestal (y) = ( 1.78 ).
    - pressure (x,y,z) = ( 0.42, 2.45, -23.8 ).
    - intake (x,y,z), ( 0.45, 2.1, -23.8 ), engine (x,y,z) = ( 0.5, 1.8, -23.8 ).
    - lighting (x,y,z) = ( 0.50, 1.8, -24.1 ).
    - air (x,y) = ( 0.35, 2.6 ).
    - fuel (x) = ( 0.53 ), fuel top (x) = ( 0.43 ).
    - hydraulics (x,y,z) = ( 0.34, 2.65, -23.0 ).
    - electrical (x,z) = ( 0.535,-23.0 ), electrical top ( 0.43, 2.45, -23.0 ).
    - steward (z) = ( -19.3 ).
-->
<!--
   <key n="101">
    <name>e</name>
    <desc>debug panel plan</desc>
    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/y-offset-m</property>
     <value>2.7</value>
    </binding>
    <binding>
     <command>property-assign</command>
     <property>/sim/current-view/z-offset-m</property>
     <value>-24.4</value>
    </binding>
   </key>
-->

   <key n="102">
    <name>f</name>
    <desc>full cockpit</desc>
    <binding>
     <command>property-toggle</command>
     <property>/sim/current-view/seat/all</property>
    </binding>
   </key>

   <key n="103">
    <name>g</name>
    <desc>Gear Up.</desc>
    <binding>
     <condition include="../Panels/Instruments/concorde-cond-gear-up.xml"/>
     <command>nasal</command>
     <script>controls.gearToggle()</script>
    </binding>
   </key>

   <key n="113">
    <name>q</name>
    <desc>reset speed-up.</desc>
    <binding>
     <command>property-assign</command>
     <property>/sim/speed-up</property>
     <value>1</value>
    </binding>
   </key>

   <key n="118">
    <name>v</name>
    <desc>Cycle view</desc>
    <desc>Scroll through views.</desc>
    <binding>
     <command>nasal</command>
     <script>
       # if specific view, step once more to ignore captain view 
       if( getprop("/sim/current-view/seat/engineer") ) {
           if( getprop("/sim/current-view/view-number") == 6 ) {
               view.stepView(4);
           }
       }
       elsif( getprop("/sim/current-view/seat/overhead") ) {
           if( getprop("/sim/current-view/view-number") == 5 ) {
               view.stepView(1);
           }
           elsif( getprop("/sim/current-view/view-number") == 7 ) {
               view.stepView(3);
           }
       }
       elsif( getprop("/sim/current-view/seat/copilot") ) {
           if( getprop("/sim/current-view/view-number") == 5 ) {
               view.stepView(2);
           }
           elsif( getprop("/sim/current-view/view-number") == 8 ) {
               view.stepView(2);
           }
       }
       elsif( getprop("/sim/current-view/seat/steward") ) {
           if( getprop("/sim/current-view/view-number") == 5 ) {
               view.stepView(3);
           }
           elsif( getprop("/sim/current-view/view-number") == 9 ) {
               view.stepView(1);
           }
       }
       else {
           if( getprop("/sim/current-view/view-number") == 5 ) {
               view.stepView(4);
           }
       }
       # default
       view.stepView(1);
     </script>
    </binding>
   </key>

<!-- datum adjust (overrides default) -->

   <key n="357">
    <name>Up</name>
    <desc>Increase elevator or autopilot altitude.</desc>
    <repeatable type="bool">true</repeatable>
    <binding>
     <command>nasal</command>
     <script>
       if( !globals.Concorde.autopilotsystem.datumapexport(1.0) ) {
           controls.incElevator(0.05, -100);
       }
     </script>
    </binding>
   </key>

   <key n="359">
    <name>Down</name>
    <desc>Decrease elevator or autopilot altitude.</desc>
    <repeatable type="bool">true</repeatable>
    <binding>
     <command>nasal</command>
     <script>
       if( !globals.Concorde.autopilotsystem.datumapexport(-1.0) ) {
           controls.incElevator(-0.05, 100);
       }
     </script>
    </binding>
   </key>

   <key n="360">
    <name>PageUp</name>
    <desc>Increase throttle or autopilot autothrottle.</desc>
    <repeatable type="bool">true</repeatable>
    <binding>
     <command>nasal</command>
     <script>
       if( !globals.Concorde.autothrottlesystem.datumatexport(1.0) ) {
           controls.incThrottle(0.01, 1.0);
       }
     </script>
    </binding>
   </key>

   <key n="361">
    <name>PageDown</name>
    <desc>Decrease throttle or autopilot autothrottle.</desc>
    <repeatable type="bool">true</repeatable>
    <binding>
     <command>nasal</command>
     <script>
       if( !globals.Concorde.autothrottlesystem.datumatexport(-1.0) ) {
           controls.incThrottle(-0.01, -1.0);
       }
     </script>
    </binding>
   </key>

   <key n="362">
    <name>Home</name>
    <desc>Increase elevator trim.</desc>
    <repeatable type="bool">true</repeatable>
    <binding>
     <command>nasal</command>
     <script>
       if( !globals.Concorde.autopilotsystem.datumapexport(0.1) ) {
           # default
           trim = getprop("/controls/flight/elevator-trim");
           trim = trim + 0.001;
           setprop("/controls/flight/elevator-trim",trim);
       }
     </script>
    </binding>
   </key>

   <key n="363">
    <name>End</name>
    <desc>Decrease elevator trim.</desc>
    <repeatable type="bool">true</repeatable>
    <binding>
     <command>nasal</command>
     <script>
       if( !globals.Concorde.autopilotsystem.datumapexport(-0.1) ) {
           # default
           trim = getprop("/controls/flight/elevator-trim");
           trim = trim - 0.001;
           setprop("/controls/flight/elevator-trim",trim);
       }
     </script>
    </binding>
   </key>

</PropertyList>


